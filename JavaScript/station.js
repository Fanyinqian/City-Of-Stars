/* 
    更换头像
*/
let userHead = document.querySelector('.user img');
userHead.src = `http://106.55.197.233:666/upload/${getCookie('headPortrait')}`;

/* 
    渲染电台详细信息
*/
let stationHeader = document.querySelector('.station-header');
let recordWrapper = document.querySelector('.record-wrapper');
// 获取开始录音按钮
let recordBtn = document.querySelector('.record');
// 获取结束录音按钮
let finishBtn = document.querySelector('.finish');
// 获取删除录音按钮
let deleteBtn = document.querySelector('.delete');

sealAjax({
    url: 'http://106.55.197.233:666/cityofstar/radio/getRadioInfo',
    data: { radioId: `${getCookie('otherRadioId')}`, userId: `${getCookie('userId')}` }
}).then(res => {
    console.log(res);
    stationHeader.innerHTML = ` <div class="station-img">
                                    <img src="http://106.55.197.233:666/upload/${res.data.radio.radioCoverImgPath}" alt="">
                                </div>
                                <div class="station-info">
                                    <div class="station-name">
                                        <svg t="1665209366804" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="9456" width="200" height="200"><path d="M510.777 513.223m-418.146 0a418.146 418.146 0 1 0 836.292 0 418.146 418.146 0 1 0-836.292 0Z" fill="#f4ea2a" p-id="9457" data-spm-anchor-id="a313x.7781069.0.i40" class="selected"></path><path d="M479.86 198.314l288.289 142.407L517.17 927.004l-334.273-143.84z" fill="#FF76C4" p-id="9458" data-spm-anchor-id="a313x.7781069.0.i35" class=""></path><path d="M594.723 515l56.971 13.562-160.492 347.983L231.715 759.55l45.741-91.05z" fill="#FC5BBF" p-id="9459" data-spm-anchor-id="a313x.7781069.0.i36" class=""></path><path d="M679.113 452.229c-0.13 0.45-0.276 0.894-0.438 1.333L680 452l-0.887 0.229zM543.296 596.01c-30.858 34.972-185.843 192.303-187.405 193.889-3.691 3.818-8.695 5.941-14.056 5.941h-0.001a19.5 19.5 0 0 1-13.618-5.507l-95.998-92.79-15.18 30.112s103.834 87.171 117.44 93.485c20.314 9.426 263.237-272.739 329.119-349.878-26.722 26.961-95.665 96.828-120.301 124.748z" fill="#f4ea2a" p-id="9460" data-spm-anchor-id="a313x.7781069.0.i37" class="selected"></path><path d="M521.767 928.972a5 5 0 0 1-6.573 2.625L180.92 787.757a4.998 4.998 0 0 1-2.481-6.857l46.096-90.784-123.304-119.184c-5.079-4.909-6.906-11.918-5.479-18.356l-1.241 0.471s-1.88 55.293 3.26 63.953c5.14 8.661 94.266 79.554 94.266 79.554S155.425 749.482 145 780.528c-2.996 8.922 4.476 21.935 7.42 24.544C175.667 825.667 500.497 955.938 528.748 949c11.8-2.898 45.506-103.921 79.513-222.079l-86.494 202.051z" fill="#280D0D" p-id="9461"></path><path d="M590.273 618.859a4.976 4.976 0 0 1-2.097-0.463l-203.327-94.095a5.001 5.001 0 0 1 4.2-9.076l203.327 94.095a5.001 5.001 0 0 1-2.103 9.539zM577.665 646.103a4.976 4.976 0 0 1-2.097-0.463l-203.327-94.095a5.001 5.001 0 0 1 4.2-9.076l203.327 94.095a5.001 5.001 0 0 1-2.103 9.539zM565.057 673.347a4.976 4.976 0 0 1-2.097-0.463l-203.327-94.095a5.001 5.001 0 0 1 4.2-9.076l203.327 94.095a5.001 5.001 0 0 1-2.103 9.539zM552.45 700.591a4.976 4.976 0 0 1-2.097-0.463l-203.327-94.095a5.001 5.001 0 0 1 4.2-9.076l203.327 94.095a5.001 5.001 0 0 1-2.103 9.539zM539.841 727.835a4.976 4.976 0 0 1-2.097-0.463l-203.326-94.095a5.001 5.001 0 0 1 4.2-9.076l203.326 94.095a5.001 5.001 0 0 1-2.103 9.539zM527.233 755.08a4.976 4.976 0 0 1-2.097-0.463L321.81 660.522a5.001 5.001 0 0 1 4.2-9.076l203.326 94.095a5.001 5.001 0 0 1-2.103 9.539zM514.943 781.638a4.976 4.976 0 0 1-2.097-0.463L309.519 687.08a5.001 5.001 0 0 1 4.2-9.076l203.327 94.095a5.001 5.001 0 0 1-2.103 9.539zM502.653 808.196a4.976 4.976 0 0 1-2.097-0.463l-203.327-94.095a5.001 5.001 0 0 1 4.2-9.076l203.327 94.095a5.001 5.001 0 0 1-2.103 9.539zM490.363 834.753a4.976 4.976 0 0 1-2.097-0.463l-203.327-94.095a5.001 5.001 0 0 1 4.2-9.076l203.327 94.095a5.001 5.001 0 0 1-2.103 9.539z" fill="#FF76C4" p-id="9462"></path><path d="M517.17 932.004a5.001 5.001 0 0 1-1.976-0.407L180.92 787.757a4.998 4.998 0 0 1-2.481-6.857l296.963-584.85a4.998 4.998 0 0 1 6.672-2.219l288.289 142.405a5.001 5.001 0 0 1 2.382 6.451L521.767 928.972a5 5 0 0 1-4.597 3.032zM189.767 780.677l324.778 139.754 247.144-577.324-279.61-138.119-292.312 575.689z" fill="#280D0D" p-id="9463"></path><path d="M638.69 246.767l-201.607-35.086a14.593 14.593 0 0 0-12.997 4.236s-79.97 72.461-148.973 143.514c-53.237 54.818-170.757 187.267-170.757 187.267-5.602 5.796-5.445 15.036 0.351 20.639l226.985 219.402c5.796 5.602 15.036 5.445 20.639-0.351 0 0 156.093-158.414 187.217-193.688s131.23-135.765 131.23-135.765a14.597 14.597 0 0 0 3.98-12.023l-24.095-185.644a14.599 14.599 0 0 0-11.973-12.501z" fill="#FFF6EE" p-id="9464"></path><path d="M613.959 270.981L450.33 245.875c-4.179-0.671-8.477 0.786-11.475 3.888 0 0-71.183 64.739-132.711 128.102-47.47 48.886-160.047 176.047-160.047 176.047-4.996 5.168-4.973 13.295 0.052 18.152l187.7 162.588c5.024 4.857 13.147 4.604 18.143-0.565 0 0 142.86-134.47 170.653-165.887 27.792-31.417 117.021-121.065 117.021-121.065 2.752-2.848 4.095-6.759 3.647-10.626l-18.987-154.68c-0.645-5.566-4.846-9.962-10.367-10.848z" fill="#FFCCC0" p-id="9465"></path><path d="M280.992 405.89l229.785 175.254-158.785 152.943s-4.992 4.049-9.242 4.337c-4.65 0.315-9.829-3.744-9.829-3.744l-182.09-157.683s-8.466-6.952-8.466-12.747c0-6.557 3.364-10.25 3.364-10.25l135.263-148.11z" fill="#FF8888" p-id="9466" data-spm-anchor-id="a313x.7781069.0.i38" class=""></path><path d="M578.289 311.125m-29.595 0a29.595 29.595 0 1 0 59.19 0 29.595 29.595 0 1 0-59.19 0Z" fill="#FFF6EE" p-id="9467"></path><path d="M578.272 345.721a34.653 34.653 0 0 1-21.97-7.887c-7.134-5.873-11.555-14.173-12.446-23.37-0.892-9.197 1.851-18.192 7.724-25.326 6.596-8.013 16.337-12.608 26.726-12.608 7.99 0 15.792 2.801 21.971 7.887 7.134 5.873 11.555 14.173 12.446 23.37 0.892 9.197-1.851 18.192-7.724 25.326-6.598 8.012-16.338 12.608-26.727 12.608z m0.033-59.192a24.53 24.53 0 0 0-19.005 8.964c-4.175 5.072-6.126 11.467-5.492 18.006s3.776 12.439 8.849 16.614a24.632 24.632 0 0 0 15.615 5.607 24.528 24.528 0 0 0 19.005-8.964c4.175-5.072 6.126-11.467 5.492-18.006s-3.776-12.439-8.849-16.614a24.635 24.635 0 0 0-15.615-5.607z" fill="#280D0D" p-id="9468"></path><path d="M741.405 136.564c-27.992-24.965-53.449-21.478-69.877-14.155-33.253 14.821-59.159 57.755-75.036 91.161a445.476 445.476 0 0 0-8.598 19.283l-149.953-26.097a19.646 19.646 0 0 0-3.362-0.291 19.697 19.697 0 0 0-13.965 5.852c-3.498 3.175-81.965 74.514-149.088 143.632-52.198 53.748-167.483 183.57-170.844 187.356-7.43 7.774-7.193 20.144 0.549 27.627l226.985 219.401a19.5 19.5 0 0 0 13.618 5.507h0.001c5.361 0 10.365-2.123 14.056-5.941 1.562-1.586 156.547-158.917 187.405-193.889 30.669-34.758 130.023-134.542 131.076-135.6a19.495 19.495 0 0 0 5.343-16.141L658.588 281.49a9.956 9.956 0 0 0 3.442-0.634c0.943-0.356 23.365-8.879 47.186-23.396 33.446-20.383 52.497-41.977 56.624-64.182 3.694-19.877-4.527-38.958-24.435-56.714z m-74.173 316.842c-1.002 1.006-100.569 101.004-131.436 135.985-30.678 34.768-185.469 191.903-187.063 193.521a9.513 9.513 0 0 1-6.899 2.927h-0.001a9.55 9.55 0 0 1-6.668-2.696L108.18 563.742c-3.804-3.677-3.907-9.764-0.23-13.569l0.145-0.156c1.174-1.324 118.054-132.992 170.604-187.102 68.097-70.12 147.945-142.569 148.744-143.293l0.238-0.23a9.644 9.644 0 0 1 6.898-2.927c0.55 0 1.104 0.048 1.644 0.141l147.828 25.727c-9.946 25.345-15.735 46.746-15.763 53.961-0.033 8.592 4.212 15.788 11.08 18.781a17.567 17.567 0 0 0 7.077 1.474c5.252 0 11.912-2.267 19.725-9.583 4.031-3.776 4.238-10.104 0.463-14.135-3.776-4.031-10.104-4.239-14.134-0.463-1.77 1.657-3.153 2.655-4.157 3.255 0.597-5.729 6.119-25.619 15.848-49.786l33.64 5.854a9.553 9.553 0 0 1 7.87 8.219l24.095 185.644c0.378 2.914-0.575 5.794-2.563 7.852z m78.947-263.795c-6.13 33.058-66.137 62.841-90.155 72.128l-0.404-3.115c-1.111-8.559-7.571-15.304-16.073-16.783l-31.417-5.468c2.1-4.882 4.351-9.876 6.757-14.913 20.454-42.824 43.61-71.579 65.201-80.969 16.135-7.019 31.839-3.421 48.005 10.998 14.524 12.955 20.44 25.425 18.086 38.122z" fill="#280D0D" p-id="9469"></path><path d="M526.76 445.964a4.979 4.979 0 0 1-3.044-1.036l-92.227-70.914a5 5 0 0 1 6.096-7.928L529.811 437a5 5 0 0 1-3.051 8.964z m-12.914-44.076a4.979 4.979 0 0 1-3.044-1.036l-33.199-25.527a5 5 0 0 1 6.096-7.928l33.199 25.527a5 5 0 0 1-3.052 8.964z m-22.813 49.131a4.979 4.979 0 0 1-3.044-1.036l-56.5-43.442a5 5 0 0 1 6.096-7.928l56.5 43.442a5 5 0 0 1-3.052 8.964z m-4.782 30.868a4.979 4.979 0 0 1-3.044-1.036l-85.832-65.997a5 5 0 0 1 6.096-7.928l85.832 65.997a5 5 0 0 1-3.052 8.964z m4.782 38.109a4.979 4.979 0 0 1-3.044-1.036L355.231 416.882a5 5 0 0 1 6.096-7.928l132.757 102.078a5 5 0 0 1-3.051 8.964z" fill="#FF8888" p-id="9470"></path><path d="M393.436 277.51m-9.75 0a9.75 9.75 0 1 0 19.5 0 9.75 9.75 0 1 0-19.5 0Z" fill="#FF76C4" p-id="9471"></path><path d="M320.383 343.156m-9.75 0a9.75 9.75 0 1 0 19.5 0 9.75 9.75 0 1 0-19.5 0Z" fill="#FF76C4" p-id="9472"></path><path d="M256.37 407.942m-9.75 0a9.75 9.75 0 1 0 19.5 0 9.75 9.75 0 1 0-19.5 0Z" fill="#FF76C4" p-id="9473"></path><path d="M202.107 469.572m-9.75 0a9.75 9.75 0 1 0 19.5 0 9.75 9.75 0 1 0-19.5 0Z" fill="#FF76C4" p-id="9474"></path><path d="M142.92 537.106m-9.75 0a9.75 9.75 0 1 0 19.5 0 9.75 9.75 0 1 0-19.5 0Z" fill="#FF76C4" p-id="9475"></path><path d="M173.701 615.435m-9.75 0a9.75 9.75 0 1 0 19.5 0 9.75 9.75 0 1 0-19.5 0Z" fill="#FF76C4" p-id="9476"></path><path d="M251.554 684.443m-9.75 0a9.75 9.75 0 1 0 19.5 0 9.75 9.75 0 1 0-19.5 0Z" fill="#FF76C4" p-id="9477"></path><path d="M373.937 740.571m-9.75 0a9.75 9.75 0 1 0 19.5 0 9.75 9.75 0 1 0-19.5 0Z" fill="#FF76C4" p-id="9478"></path><path d="M514.403 595.936m-9.75 0a9.75 9.75 0 1 0 19.5 0 9.75 9.75 0 1 0-19.5 0Z" fill="#FF76C4" p-id="9479"></path><path d="M578.843 527.357m-9.75 0a9.75 9.75 0 1 0 19.5 0 9.75 9.75 0 1 0-19.5 0Z" fill="#FF76C4" p-id="9480"></path><path d="M652.248 450.978m-9.75 0a9.75 9.75 0 1 0 19.5 0 9.75 9.75 0 1 0-19.5 0Z" fill="#FF76C4" p-id="9481"></path><path d="M643.951 362.655m-9.75 0a9.75 9.75 0 1 0 19.5 0 9.75 9.75 0 1 0-19.5 0Z" fill="#FF76C4" p-id="9482"></path><path d="M630.695 267.76m-9.75 0a9.75 9.75 0 1 0 19.5 0 9.75 9.75 0 1 0-19.5 0Z" fill="#FF76C4" p-id="9483"></path><path d="M527.317 248.15m-9.75 0a9.75 9.75 0 1 0 19.5 0 9.75 9.75 0 1 0-19.5 0Z" fill="#FF76C4" p-id="9484"></path><path d="M289.25 493.25c6.449 0 6.449-10 0-10s-6.449 10 0 10zM272.435 497.617c-11.414 11.31-22.386 23.187-34.72 33.519-4.949 4.146 2.164 11.182 7.071 7.071 12.335-10.332 23.307-22.208 34.72-33.519 4.585-4.544-2.488-11.613-7.071-7.071z" fill="#FFFFFF" p-id="9485"></path><path d="M152.115 556.75s45.551-30.408 75.551-22.079 25.333 32.98 70 27.988 78.466-32.326 89.9-9.659 29.805 40.836 60.953 30.751 48.731 9.75 48.731 9.75L348.946 735.37a11.009 11.009 0 0 1-14.86 0.33L145.671 570.83c-4.221-3.693-2.97-10.555 2.282-12.521l4.162-1.559z" fill="#FC7A7A" p-id="9486"></path><path d="M184 613c1.935 0 1.935-3 0-3s-1.935 3 0 3zM199.004 652.383c25.688 0.877 51.386 0.306 77.01-1.711 1.915-0.151 1.93-3.152 0-3a683.792 683.792 0 0 1-77.01 1.711c-1.935-0.066-1.929 2.934 0 3zM190.494 641.69c15.001-0.279 30.003-0.328 45.005-0.145 1.935 0.024 1.933-2.976 0-3a1461.453 1461.453 0 0 0-45.005 0.145c-1.932 0.036-1.936 3.036 0 3zM245.5 641.5h5.5c1.935 0 1.935-3 0-3h-5.5c-1.935 0-1.935 3 0 3zM174.988 633.255c12.997-0.621 26.002-0.997 39.013-1.128 1.933-0.019 1.935-3.019 0-3-13.011 0.131-26.016 0.507-39.013 1.128-1.926 0.092-1.935 3.093 0 3zM160.999 622.472a605.147 605.147 0 0 1 35.001-0.454c1.936 0.031 1.933-2.969 0-3a605.147 605.147 0 0 0-35.001 0.454c-1.927 0.081-1.935 3.081 0 3zM204 622h5.5c1.935 0 1.935-3 0-3H204c-1.935 0-1.935 3 0 3zM220 631.5h9c1.935 0 1.935-3 0-3h-9c-1.935 0-1.935 3 0 3zM142.752 604.44a761.94 761.94 0 0 0 49.495-0.018c1.929-0.063 1.936-3.064 0-3a761.94 761.94 0 0 1-49.495 0.018c-1.935-0.062-1.929 2.938 0 3zM152.999 613.994a141.64 141.64 0 0 1 22.999-0.962c1.935 0.076 1.928-2.924 0-3-7.701-0.303-15.35 0.016-22.999 0.962-1.894 0.234-1.917 3.237 0 3zM196.303 604.422h10.5c1.935 0 1.935-3 0-3h-10.5c-1.934 0-1.934 3 0 3zM128.995 589.938l49.027-3.636c1.917-0.142 1.931-3.143 0-3l-49.027 3.636c-1.917 0.142-1.931 3.143 0 3zM115.007 574.685l42.495-1.638c1.928-0.074 1.935-3.075 0-3l-42.495 1.638c-1.928 0.074-1.935 3.075 0 3zM124 582h19.5c1.935 0 1.935-3 0-3H124c-1.935 0-1.935 3 0 3zM150.5 582h8.5c1.935 0 1.935-3 0-3h-8.5c-1.935 0-1.935 3 0 3zM107.487 563.375a611.663 611.663 0 0 1 40.015-2.83c1.928-0.073 1.935-3.073 0-3a611.663 611.663 0 0 0-40.015 2.83c-1.905 0.198-1.924 3.2 0 3zM153.499 559.485l7.494-0.583c1.916-0.149 1.93-3.15 0-3l-7.494 0.583c-1.916 0.149-1.93 3.15 0 3zM106.997 549.283l29.501-0.406c1.933-0.027 1.936-3.027 0-3l-29.501 0.406c-1.933 0.027-1.936 3.027 0 3zM107 556.5h11c1.935 0 1.935-3 0-3h-11c-1.935 0-1.935 3 0 3zM126 555.5h3c1.935 0 1.935-3 0-3h-3c-1.935 0-1.935 3 0 3zM119.5 536.507a512.02 512.02 0 0 1 31.497 0.06c1.936 0.063 1.929-2.937 0-3a512.815 512.815 0 0 0-31.497-0.06c-1.93 0.055-1.935 3.056 0 3zM160 538.5h6c1.935 0 1.935-3 0-3h-6c-1.935 0-1.935 3 0 3zM145.5 549c1.935 0 1.935-3 0-3s-1.935 3 0 3zM167.5 578.5c1.935 0 1.935-3 0-3s-1.935 3 0 3zM192 628.5c1.935 0 1.935-3 0-3s-1.935 3 0 3zM262.5 644c1.935 0 1.935-3 0-3s-1.935 3 0 3z" fill="#280D0D" p-id="9487"></path></svg>
                                        <h2>${res.data.radio.radioName}</h2>
                                    </div>
                                    <div class="author-info">
                                        <img src="http://106.55.197.233:666/upload/${res.data.headPortrait}" alt="主播头像">
                                        <span>${res.data.username}</span>
                                    </div>
                                    <div class="concern-wrapper">
                                        <a class="like" href="javascript:;">
                                            <svg t="1665210581285" class="icon default" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="1032" width="200" height="200"><path d="M481.706667 851.626667a64 64 0 0 1-34.773334-10.453334c-96.64-64-405.333333-287.573333-308.053333-505.386666a215.68 215.68 0 0 1 342.826667-73.386667 214.613333 214.613333 0 0 1 170.666666-54.613333 216.96 216.96 0 0 1 170.666667 128 232.32 232.32 0 0 1-6.4 194.56l-57.173333-26.026667a168.96 168.96 0 0 0 6.4-141.653333 151.68 151.68 0 0 0-248.96-44.373334 50.56 50.56 0 0 1-70.613334 0A151.68 151.68 0 0 0 197.333333 362.666667C119.466667 537.813333 420.693333 746.666667 481.92 787.626667c20.266667-13.866667 53.12-36.48 90.24-66.346667l40.106667 49.92c-39.04 31.36-73.6 55.466667-95.786667 69.973333a64 64 0 0 1-34.773333 10.453334z" fill="#A2A2A2" p-id="1033"></path><path d="M710.826667 868.053333a87.253333 87.253333 0 0 1-50.986667-16.426666c-142.933333-102.826667-197.12-211.413333-149.333333-298.666667A135.04 135.04 0 0 1 710.826667 512a135.04 135.04 0 0 1 199.466666 42.666667c48.64 85.333333-5.333333 194.773333-149.333333 298.666666a87.466667 87.466667 0 0 1-50.133333 14.72z m-81.92-318.72a74.88 74.88 0 0 0-14.293334 1.493334 71.04 71.04 0 0 0-47.36 34.773333c-45.013333 79.573333 88.106667 184.106667 129.92 213.333333a23.466667 23.466667 0 0 0 27.306667 0c42.666667-30.08 174.933333-134.613333 129.92-213.333333a71.04 71.04 0 0 0-47.36-34.773333 71.893333 71.893333 0 0 0-66.133333 21.333333 42.666667 42.666667 0 0 1-60.16 0 71.466667 71.466667 0 0 0-51.84-22.826667z m65.706666-21.333333z m32.426667 0z" fill="#A2A2A2" p-id="1034"></path><path d="M315.093333 492.373333a32 32 0 0 1-32-32 95.573333 95.573333 0 0 1 95.573334-95.573333 32 32 0 0 1 0 64 31.573333 31.573333 0 0 0-31.573334 31.573333 32 32 0 0 1-32 32z" fill="#FC455D" p-id="1035"></path></svg> 
                                            <svg t="1665211588718" class="icon select" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="1380" width="200" height="200"><path d="M882.346667 569.813333c56.106667 99.2-75.306667 209.92-139.093334 256a55.466667 55.466667 0 0 1-64 0c-64-45.866667-195.2-156.586667-139.093333-256a103.04 103.04 0 0 1 164.693333-21.333333 9.386667 9.386667 0 0 0 13.653334 0 103.04 103.04 0 0 1 164.693333 21.333333z" fill="#FC455D" p-id="1381"></path><path d="M815.36 337.066667a195.413333 195.413333 0 0 0-320-56.96 17.92 17.92 0 0 1-26.026667 0A195.413333 195.413333 0 0 0 149.333333 337.066667C54.613333 547.413333 381.226667 778.88 463.36 832a33.28 33.28 0 0 0 36.693333 0c81.92-53.12 408.533333-284.586667 315.306667-494.933333z m-390.186667 28.586666a32 32 0 0 1-40.106666 21.333334 64 64 0 0 0-81.493334 74.666666 32 32 0 1 1-62.506666 13.44 128 128 0 0 1 162.986666-149.333333 32 32 0 0 1 21.12 39.893333z" fill="#FC455D" p-id="1382"></path></svg>
                                            <span>关注</span>
                                        </a>
                                        <!-- 电台标签 -->
                                    <div class="station-tag">
                                            <svg t="1667525694965" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="1165" width="200" height="200"><path d="M568.1152 945.7152c-47.872 0-92.8768-18.6368-126.72-52.48l-301.7728-301.7728c-33.792-33.792-52.9408-80.5888-52.48-128.4096l2.56-273.152a114.98496 114.98496 0 0 1 111.4112-114.0224l281.2928-9.1648c49.3568-1.6384 97.6384 17.5104 132.5568 52.3776a25.61536 25.61536 0 0 1 0 36.1984 25.61536 25.61536 0 0 1-36.1984 0 128.37888 128.37888 0 0 0-94.6688-37.4272l-281.2928 9.1648c-34.3552 1.1264-61.5424 28.928-61.9008 63.3344l-2.56 273.152c-0.3072 34.1504 13.3632 67.584 37.4784 91.6992l301.7728 301.7728c24.1664 24.1664 56.32 37.4784 90.5216 37.4784s66.3552-13.312 90.5216-37.4784l220.416-220.416c24.1664-24.1664 37.4784-56.32 37.4784-90.5216s-13.312-66.3552-37.4784-90.5216L691.712 268.3392c-9.984-9.984-10.0352-26.2144 0-36.1984a25.61536 25.61536 0 0 1 36.1984 0l187.3408 187.1872c33.8432 33.8432 52.48 78.848 52.48 126.72s-18.6368 92.8768-52.48 126.72l-220.416 220.416c-33.8944 33.8944-78.8992 52.5312-126.72 52.5312z" fill="#13227a" p-id="1166"></path><path d="M369.8176 347.0336m-86.6816 0a86.6816 86.6816 0 1 0 173.3632 0 86.6816 86.6816 0 1 0-173.3632 0Z" fill="#FFD833" p-id="1167"></path><path d="M369.8176 459.3152c-61.9008 0-112.2816-50.3808-112.2816-112.2816s50.3808-112.2816 112.2816-112.2816 112.2816 50.3808 112.2816 112.2816-50.3808 112.2816-112.2816 112.2816z m0-173.3632c-33.6896 0-61.0816 27.392-61.0816 61.0816s27.392 61.0816 61.0816 61.0816 61.0816-27.392 61.0816-61.0816-27.392-61.0816-61.0816-61.0816zM414.6688 677.7344c-6.6048 0-13.2096-2.56-18.2272-7.6288a25.5744 25.5744 0 0 1 0.256-36.1984l261.7856-258.4064a25.5744 25.5744 0 0 1 36.1984 0.256 25.5744 25.5744 0 0 1-0.256 36.1984L432.64 670.3616c-4.9664 4.9152-11.4688 7.3728-17.9712 7.3728zM523.2128 791.3984c-6.5536 0-13.1072-2.5088-18.1248-7.4752a25.61536 25.61536 0 0 1 0-36.1984l192.8192-192.8192a25.61536 25.61536 0 0 1 36.1984 0 25.61536 25.61536 0 0 1 0 36.1984l-192.8192 192.8192c-4.9664 4.9664-11.52 7.4752-18.0736 7.4752z" fill="#44454A" p-id="1168"></path></svg>
                                            ${res.data.radio.radioTag}
                                    </div>
                                    </div>
                                    <div class="intro">
                                        <svg t="1665214163110" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="12185" width="200" height="200"><path d="M407.7 922.2C182.9 922.2 0 739.3 0 514.5c0-224.8 182.9-407.6 407.7-407.6 224.8 0 407.6 182.9 407.6 407.6 0 224.8-182.9 407.7-407.6 407.7z m0-744.5C222 177.7 70.9 328.8 70.9 514.5S222 851.3 407.7 851.3s336.8-151.1 336.8-336.8-151.1-336.8-336.8-336.8z" fill="#232426" p-id="12186"></path><path d="M407.7 660.5c-80.5 0-146-65.5-146-146s65.5-146 146-146 146 65.5 146 146-65.5 146-146 146z m0-221.2c-41.5 0-75.2 33.7-75.2 75.2s33.7 75.2 75.2 75.2 75.2-33.7 75.2-75.2-33.8-75.2-75.2-75.2z" fill="#232426" p-id="12187"></path><path d="M1022.5 270C929 108.8 760.4 99.9 701.6 102.1c-9 0.3-13.9 10.7-8.5 17.9C914 415.4 898.4 534 891 559.2c-32-15.7-73-19.8-114.4-8.1C698.2 573.3 648.2 643 665 706.9c16.8 63.9 94 97.8 172.4 75.6 60.7-17.2 98.4-50.7 122.3-103 54.1-118-64.6-353.1-108.4-432.8-5-9.2 4.1-19.6 13.8-15.9l143.7 55.3c9.7 3.8 18.9-6.9 13.7-16.1z" fill="#FFCF41" p-id="12188"></path></svg>
                                        ${res.data.radio.radioIntro}
                                </div>
                            `


    /* 
        电台页基础设置
    */
    let like = document.querySelector(".like");
    // 获取电台标签
    let stationTag = document.querySelector('.station-tag');
    // 判断进入的电台页是自己的还是别人的
    if (getCookie('myRadioId') == getCookie('otherRadioId')) {
        // 我的电台页设置
        console.log('我的');
        like.style.opacity = '0';
        recordWrapper.style.height = '112px';
        recordBtn.style.boxShadow = '0px 9px 0px rgb(219 31 5), 0px 9px 25px rgb(0 0 0 / 70%)';
        deleteBtn.style.boxShadow = '0px 9px 0px #0c73c2, 0px 9px 25px rgb(0 0 0 / 70%)';
        stationTag.style.left = '-91px';
    } else {
        // 别人的电台页设置
        console.log('别人的');
        like.style.opacity = '1';
        recordWrapper.style.height = '0';
        recordBtn.style.boxShadow = 'none';
        deleteBtn.style.boxShadow = 'none';
        stationTag.style.left = '45px';
    }


    /* 
        关注 && 取关
    */

    // 默认状态
    let defaultBtn = document.querySelector(".default");
    // 选中状态
    let selectBtn = document.querySelector(".select");
    // 关注文本
    let concernText = document.querySelector(".like span");
    // 初始化标识
    let flag = 1;
    like.onclick = () => {
        if (flag % 2) {
            selectBtn.style.display = "block";
            defaultBtn.style.display = "none";
            concernText.innerText = "取消关注";
        } else {
            selectBtn.style.display = "none";
            defaultBtn.style.display = "block";
            concernText.innerText = "关注";
        }
        flag++;
    }
});


/* 
    渲染全部节目
*/
let stationUl = document.querySelector('.station-body ul');
sealAjax({
    url: 'http://106.55.197.233:666/cityofstar/radioShow/getOneRadioShowList',
    data: { radioId: `${getCookie('myRadioId')}` },
    headers: {
        'Content-Type': 'multipart/form-data'
    },
}).then(res => {
    console.log(res);
    for (i in res.data) {
        stationUl.innerHTML += `<li>
                                    <div class="rank-play">
                                        <svg t="1664865984965" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2724" width="200" height="200"><path d="M744.727273 551.563636L325.818182 795.927273c-30.254545 18.618182-69.818182-4.654545-69.818182-39.563637v-488.727272c0-34.909091 39.563636-58.181818 69.818182-39.563637l418.909091 244.363637c30.254545 16.290909 30.254545 62.836364 0 79.127272z" p-id="2725" data-spm-anchor-id="a313x.7781069.0.i2" class="selected" fill="#ffffff"></path></svg>
                                    </div>
                                    <div class="program-name">${res.data[i].showName}</div>
                                    <svg t="1665210581285" class="icon default" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="1032" width="200" height="200"><path d="M481.706667 851.626667a64 64 0 0 1-34.773334-10.453334c-96.64-64-405.333333-287.573333-308.053333-505.386666a215.68 215.68 0 0 1 342.826667-73.386667 214.613333 214.613333 0 0 1 170.666666-54.613333 216.96 216.96 0 0 1 170.666667 128 232.32 232.32 0 0 1-6.4 194.56l-57.173333-26.026667a168.96 168.96 0 0 0 6.4-141.653333 151.68 151.68 0 0 0-248.96-44.373334 50.56 50.56 0 0 1-70.613334 0A151.68 151.68 0 0 0 197.333333 362.666667C119.466667 537.813333 420.693333 746.666667 481.92 787.626667c20.266667-13.866667 53.12-36.48 90.24-66.346667l40.106667 49.92c-39.04 31.36-73.6 55.466667-95.786667 69.973333a64 64 0 0 1-34.773333 10.453334z" fill="#A2A2A2" p-id="1033"></path><path d="M710.826667 868.053333a87.253333 87.253333 0 0 1-50.986667-16.426666c-142.933333-102.826667-197.12-211.413333-149.333333-298.666667A135.04 135.04 0 0 1 710.826667 512a135.04 135.04 0 0 1 199.466666 42.666667c48.64 85.333333-5.333333 194.773333-149.333333 298.666666a87.466667 87.466667 0 0 1-50.133333 14.72z m-81.92-318.72a74.88 74.88 0 0 0-14.293334 1.493334 71.04 71.04 0 0 0-47.36 34.773333c-45.013333 79.573333 88.106667 184.106667 129.92 213.333333a23.466667 23.466667 0 0 0 27.306667 0c42.666667-30.08 174.933333-134.613333 129.92-213.333333a71.04 71.04 0 0 0-47.36-34.773333 71.893333 71.893333 0 0 0-66.133333 21.333333 42.666667 42.666667 0 0 1-60.16 0 71.466667 71.466667 0 0 0-51.84-22.826667z m65.706666-21.333333z m32.426667 0z" fill="#A2A2A2" p-id="1034"></path><path d="M315.093333 492.373333a32 32 0 0 1-32-32 95.573333 95.573333 0 0 1 95.573334-95.573333 32 32 0 0 1 0 64 31.573333 31.573333 0 0 0-31.573334 31.573333 32 32 0 0 1-32 32z" fill="#FC455D" p-id="1035"></path></svg>
                                    <span>${res.data[i].likeNum}</span> 
                                    <!-- 日期 -->
                                    <div class="date">${res.data[i].recordTime.trim().split(' ')[0]}</div>
                                    <div class="duration">${res.data[i].timeLength}</div>
                                </li>
                            `
    }

});

/* 
    录制有声条
*/
let userId = getCookie('userId');
let myRadioId = getCookie('myRadioId');
// 定义计时
let begin_time;
let end_time;
let time_length;
// 获取弹窗
let popUp = document.querySelector('.popup');
// 连接麦克风
if (navigator.mediaDevices.getUserMedia) {
    const constraint = { audio: true };
    navigator.mediaDevices.getUserMedia(constraint).then(
        // 授权成功
        (stream) => {
            // 创建MediaRecord空对象
            const mediaRecorder = new MediaRecorder(stream);
            var chunks = [];
            //为开始录音按钮绑定单击响应函数
            recordBtn.onclick = () => {
                // 判断录音设备是否正在录制
                //录音处于关闭状态时
                if (mediaRecorder.state === 'inactive') {
                    //开始录制
                    mediaRecorder.start();
                    mediaRecorder.ondataavailable = function (e) {
                        chunks.push(e.data);
                    };
                    popUp.style.opacity = '1';
                    popUp.style.transform = 'scale(1)';
                    popUp.style.pointerEvents = "all";
                }
                begin_time = Date.now();
            };
            //为结束录音按钮绑定单击响应函数
            finishBtn.onclick = () => {
                // 当处于正在录音状态时
                if (mediaRecorder.state == "recording") {
                    // 关闭录音
                    mediaRecorder.stop();
                    mediaRecorder.onstop = (e) => {
                        var blob = new Blob(chunks, {
                            type: "audio/mpeg",
                        });
                        chunks = [];
                        end_time = Date.now();
                        time_length = end_time - begin_time;
                        // let audioURL = window.URL.createObjectURL(blob);
                        // const audioSrc = document.querySelector('.audio-player');
                        // audioSrc.src = audioURL;
                        const formData = new FormData();
                        formData.append('uploadfile', blob);
                        formData.append('radioId', myRadioId);
                        formData.append('userId', userId);
                        formData.append('timeLength', time_length / 1000);
                        console.log(formData);

                        let xhr = new XMLHttpRequest();
                        xhr.open('post', 'http://106.55.197.233:666/cityofstar/voice/addVoice');
                        xhr.send(formData);
                        xhr.onreadystatechange = () => {
                            if (xhr.readyState === 4) {
                                vocalAppear();
                            }
                        }
                    }
                }


                // 弹窗消失
                popUp.style.transform = 'scale(0.7)';
                popUp.style.pointerEvents = 'none';
                let timer = setTimeout(function () {
                    popUp.style.opacity = '0';
                }, 87);

            };

        },
        () => {
            alert('授权失败！');
        }
    )
} else {
    console.error("浏览器不支持 getUserMedia");
}

/* 
    渲染有声条
*/
// 获取有声条
let vocalList = document.querySelector('.vocal-list');
const urlHeader = 'http://106.55.197.233:666/upload/';
function vocalAppear() {

    sealAjax({
        url: 'http://106.55.197.233:666/cityofstar/voice/getRadioVoice',
        data: { radioId: `${getCookie('myRadioId')}` }
    }).then(res => {
        console.log(res)
        // 先清空有声条里的内容
        vocalList.innerHTML = `<audio class="audio-player"></audio>`;
        // 再进行渲染
        for (i in res.data) {
            vocalList.innerHTML += `<li>
                                        <div class="vocal-date">${res.data[i].voiceRecordDate}</div>
                                        <div class="vocal-bar">
                                            <svg t="1665372570998" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="7098" width="200" height="200"><path d="M304.48 421.504L213.952 512l90.528 90.496a128 128 0 0 0 0-180.992zM394.976 693.024l45.248 45.248c124.992-124.96 124.992-327.584 0-452.544l-45.248 45.248a256 256 0 0 1 0 362.048z" fill="#2c2c2c" p-id="7099" data-spm-anchor-id="a313x.7781069.0.i4" class="selected"></path><path d="M530.752 195.2c174.944 174.976 174.944 458.624 0 633.6L576 874.048c199.936-199.968 199.936-524.16 0-724.096l-45.248 45.28z" fill="#2c2c2c" p-id="7100" data-spm-anchor-id="a313x.7781069.0.i5" class="selected"></path></svg>
                                        </div>
                                        <svg t="1666255352302" class="icon delete-icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5744" width="200" height="200"><path d="M827.392 195.584q65.536 65.536 97.792 147.456t32.256 167.936-32.256 167.936-97.792 147.456-147.456 98.304-167.936 32.768-168.448-32.768-147.968-98.304-98.304-147.456-32.768-167.936 32.768-167.936 98.304-147.456 147.968-97.792 168.448-32.256 167.936 32.256 147.456 97.792zM720.896 715.776q21.504-21.504 18.944-49.152t-24.064-49.152l-107.52-107.52 107.52-107.52q21.504-21.504 24.064-49.152t-18.944-49.152-51.712-21.504-51.712 21.504l-107.52 106.496-104.448-104.448q-21.504-20.48-49.152-23.04t-49.152 17.92q-21.504 21.504-21.504 52.224t21.504 52.224l104.448 104.448-104.448 104.448q-21.504 21.504-21.504 51.712t21.504 51.712 49.152 18.944 49.152-24.064l104.448-104.448 107.52 107.52q21.504 21.504 51.712 21.504t51.712-21.504z" p-id="5745" data-spm-anchor-id="a313x.7781069.0.i0" class="" fill="#eb4a18"></path></svg>
                                    </li>
                                    `
        }
        let vocalBar = document.querySelectorAll('.vocal-bar');
        for (let i = 0; i < vocalBar.length; i++) {
            vocalBar[i].voiceId = res.data[i].voiceId;
            vocalBar[i].onclick = () => {
                let audio = document.querySelector('.audio-player');
                audio.src = `${urlHeader}${res.data[i].voiceContent}`;
                audio.play();
            }
        }


        /* 
            删除有声条
        */
        // 获取删除图标
        let deleteIcon = document.querySelectorAll('.delete-icon');
        deleteBtn.onclick = () => {
            for (let i = 0; i < deleteIcon.length; i++) {
                deleteIcon[i].style.opacity = '1';
                deleteIcon[i].style.top = '30px';
            }
        }
        for (let i = 0; i < deleteIcon.length; i++) {
            deleteIcon[i].onclick = () => {
                sealAjax({
                    url: 'http://106.55.197.233:666/cityofstar/voice/delRadioVoice',
                    data: { voiceId: vocalBar[i].voiceId }
                }).then(res => {
                    console.log(res)
                    // 重新渲染有声条
                    vocalAppear();
                });
            }
        }
    });
}

vocalAppear();




